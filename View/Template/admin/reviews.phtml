<?php

use Krystal\Widget\GridView\GridViewWidget;
use Krystal\Form\Element;
use Cms\View\Icon;

defined('KRYSTAL') or die;

?>

<?php $this->loadPartial('items-per-page', array('caption' => 'Reviews')); ?>

<?= $this->widget(new GridViewWidget($reviews, array(
    // A column to be considered as a primary key
    'pk' => 'id',
    'batch' => true,
    'tableClass' => 'table table-hover table-bordered table-striped table-condensed',
    'rowAttributes' => array(
        'class' => function($row){
            if ($row['published'] == 0){
                return 'danger';
            }
        }
    ),
    'columns' => array(
        array(
            'column' => 'id',
            'label' => '#'
        ),

        array(
            'column' => 'tour',
        ),

        array(
            'column' => 'datetime',
            'label' => 'Date and time'
        ),

        array(
            'column' => 'name',
        ),

        array(
            'column' => 'message',
        )
    ),

    'actions' => array(
        'approve' => function($entity){
            if ($entity['published'] == 0){
                $url = $this->url('Tour:Admin:TourReview@approveAction', $entity['id']);

                return Icon::button('glyphicon glyphicon-check', $url, $this->translate('Approve this review'));
            }
        },

        'remove' => function($row){
            return Icon::remove(
                $this->url('Tour:Admin:TourReview@deleteAction', $row['id']),
                $this->translate('Remove this review')
            );
        }
    )
))); ?>
